# 设计

## 约定

- 程序中的时间均采用`毫秒级时间戳`
- 程序中的`[]byte`在传输、保存等场景中，均使用16进制编码，以保证其可读性
- 使用`apifox`模拟前端请求，接口文件保存在`server/internal/http/api/apifox.json`
    - 用于在服务端开发过程中测试接口

## 用户服务

- 只有登录功能返回token，前端创建用户成功之后自动调用一次登录
- 密码不使用明文，界面上输入密码后执行一次hash放入请求体、服务端保存的则是密码hash加盐之后的hash
    - req: `hash('password text')`
    - db: `hash('pwd hash'+'salt')`
    - hash: `sha256`
    - 前端执行hash的目的是，即使恶意攻击窃取了http请求参数，也无法恢复出密码明文，进而攻击者无法使用我们的ui；
      后端执行hash的目的是，即使恶意攻击窃取了数据库数据，也无法恢复出密码hash，进而无法调用接口。
- 使用服务端保存`token`的方式管理用户登录状态
    - 登录成功时，服务端返回`token`，后续前端请求则需要带上该`token`
    - `token`通过自定义`header`携带
    - 设计成服务端保存，是为了**限制一个用户同时只能登录在一台设备上**
